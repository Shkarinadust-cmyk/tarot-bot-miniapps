import logging
import sqlite3
import os
import random
import time
from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
BOT_TOKEN = "8355095598:AAGi48QWU-4e66ZTR2qMYU6aiK-Py1TxjWU"

# –ü—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
DATABASE_PATH = os.path.join(os.path.dirname(__file__), '..', 'tarot_bot.db')

class TarotAI:
    """–£–º–Ω—ã–π –ò–ò –¥–ª—è –¢–∞—Ä–æ —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ —Ä–∞—Å–∫–ª–∞–¥–∞–º–∏"""
    def __init__(self):
        self.major_arcana = {
            "üÉè –®–£–¢": "–ù–æ–≤—ã–µ –Ω–∞—á–∏–Ω–∞–Ω–∏—è, –Ω–µ–≤–∏–Ω–Ω–æ—Å—Ç—å, —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç—å. –û—Ç–ª–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Å—Ç–∞—Ä—Ç–æ–≤!",
            "üßô‚Äç‚ôÄÔ∏è –ñ–†–ò–¶–ê": "–ò–Ω—Ç—É–∏—Ü–∏—è, —Ç–∞–π–Ω—ã, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ. –î–æ–≤–µ—Ä—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É!",
            "üëë –ò–ú–ü–ï–†–ê–¢–†–ò–¶–ê": "–ö—Ä–∞–±–æ—Ç–∞, –∏–∑–æ–±–∏–ª–∏–µ, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ. –ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—Ü–≤–µ—Ç–∞ –∏ –≥–∞—Ä–º–æ–Ω–∏–∏!",
            "üèõÔ∏è –ò–ú–ü–ï–†–ê–¢–û–†": "–í–ª–∞—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –í—Ä–µ–º—è —Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—á–Ω—ã–µ –æ—Å–Ω–æ–≤—ã!",
            "üìø –ñ–†–ï–¶": "–î—É—Ö–æ–≤–Ω–æ—Å—Ç—å, —Ç—Ä–∞–¥–∏—Ü–∏–∏, –º—É–¥—Ä–æ—Å—Ç—å. –ò—â–∏—Ç–µ –≤—ã—Å—à–µ–µ –∑–Ω–∞–Ω–∏–µ!",
            "üíë –í–õ–Æ–ë–õ–ï–ù–ù–´–ï": "–õ—é–±–æ–≤—å, –≤—ã–±–æ—Ä, –≥–∞—Ä–º–æ–Ω–∏—è. –í–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö!",
            "‚öîÔ∏è –°–ò–õ–ê": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–∏–ª–∞, —Å–º–µ–ª–æ—Å—Ç—å, —Å—Ç—Ä–∞—Å—Ç—å. –í—ã —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –¥—É–º–∞–µ—Ç–µ!",
            "üß≠ –û–¢–®–ï–õ–¨–ù–ò–ö": "–°–∞–º–æ–∞–Ω–∞–ª–∏–∑, –º—É–¥—Ä–æ—Å—Ç—å, —É–µ–¥–∏–Ω–µ–Ω–∏–µ. –í—Ä–µ–º—è –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π!",
            "üé° –ö–û–õ–ï–°–û –§–û–†–¢–£–ù–´": "–°—É–¥—å–±–∞, —É–¥–∞—á–∞, –ø–µ—Ä–µ–º–µ–Ω—ã. –ñ–∏–∑–Ω—å –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –∫ –≤–∞–º!",
            "‚öñÔ∏è –ü–†–ê–í–û–°–£–î–ò–ï": "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å, –∫–∞—Ä–º–∞, –ø—Ä–∞–≤–¥–∞. –í—Å–µ –≤—Å—Ç–∞–Ω–µ—Ç –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞!",
            "üôè –ü–û–í–ï–®–ï–ù–ù–´–ô": "–ñ–µ—Ä—Ç–≤–∞, –ø–∞—É–∑–∞, –Ω–æ–≤—ã–π –≤–∑–≥–ª—è–¥. –ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ—Ç–ø—É—Å—Ç–∏—Ç—å!",
            "üíÄ –°–ú–ï–†–¢–¨": "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ–Ω–µ—Ü, –Ω–æ–≤–æ–µ –Ω–∞—á–∞–ª–æ. –°—Ç–∞—Ä–æ–µ —É—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ!",
            "üïäÔ∏è –£–ú–ï–†–ï–ù–ù–û–°–¢–¨": "–ë–∞–ª–∞–Ω—Å, —Ç–µ—Ä–ø–µ–Ω–∏–µ, –≥–∞—Ä–º–æ–Ω–∏—è. –ù–∞—Ö–æ–¥–∏—Ç–µ –∑–æ–ª–æ—Ç—É—é —Å–µ—Ä–µ–¥–∏–Ω—É!",
            "üòà –î–¨–Ø–í–û–õ": "–ò—Å–∫—É—à–µ–Ω–∏—è, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Å—Ç—Ä–∞—Ö–∏. –í—Ä–µ–º—è –æ—Å–≤–æ–±–æ–¥–∏—Ç—å—Å—è!",
            "üè∞ –ë–ê–®–ù–Ø": "–í–Ω–µ–∑–∞–ø–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø—Ä–æ–∑—Ä–µ–Ω–∏–µ. –°—Ç–∞—Ä—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—É—à–∞—Ç—Å—è!",
            "‚≠ê –ó–í–ï–ó–î–ê": "–ù–∞–¥–µ–∂–¥–∞, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –∏—Å—Ü–µ–ª–µ–Ω–∏–µ. –°–≤–µ—Ç–ª—ã–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã!",
            "üåô –õ–£–ù–ê": "–ò–ª–ª—é–∑–∏–∏, —Å—Ç—Ä–∞—Ö, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ. –ü—Ä–∏—Å–ª—É—à–∞–π—Ç–µ—Å—å –∫ –∏–Ω—Ç—É–∏—Ü–∏–∏!",
            "‚òÄÔ∏è –°–û–õ–ù–¶–ï": "–†–∞–¥–æ—Å—Ç—å, —É—Å–ø–µ—Ö, —Å—á–∞—Å—Ç—å–µ. –Ø—Ä–∫–∏–π –ø–µ—Ä–∏–æ–¥ –≤–ø–µ—Ä–µ–¥–∏!",
            "üîÑ –°–£–î": "–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ, –ø—Ä–∏–∑—ã–≤, –ø—Ä–æ—â–µ–Ω–∏–µ. –í—Ä–µ–º—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π!",
            "üåç –ú–ò–†": "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ, —É—Å–ø–µ—Ö, –≥–∞—Ä–º–æ–Ω–∏—è. –í—Å–µ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω–æ!"
        }
        
        self.minor_arcana = {
            "ü™Ñ –¢–£–ó –ñ–ï–ó–õ–û–í": "–ù–æ–≤—ã–µ –Ω–∞—á–∏–Ω–∞–Ω–∏—è, —ç–Ω–µ—Ä–≥–∏—è, —ç–Ω—Ç—É–∑–∏–∞–∑–º. –°–º–µ–ª–æ –¥–≤–∏–≥–∞–π—Ç–µ—Å—å –≤–ø–µ—Ä–µ–¥!",
            "üëë –ö–û–†–û–õ–ï–í–ê –ñ–ï–ó–õ–û–í": "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, —Ö–∞—Ä–∏–∑–º–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å. –í—ã –≤ —Å–≤–æ–µ–π —Å–∏–ª–µ!", 
            "ü§¥ –ö–û–†–û–õ–¨ –ñ–ï–ó–õ–û–í": "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ, –∞–º–±–∏—Ü–∏–∏, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ. –ë–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å!",
            "üíù –¢–£–ó –ß–ê–®": "–ù–æ–≤–∞—è –ª—é–±–æ–≤—å, —ç–º–æ—Ü–∏–∏, —Ä–∞–¥–æ—Å—Ç—å. –°–µ—Ä–¥—Ü–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–ª—è —á—É–¥–µ—Å!",
            "üëë –ö–û–†–û–õ–ï–í–ê –ß–ê–®": "–ò–Ω—Ç—É–∏—Ü–∏—è, —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –î–æ–≤–µ—Ä—è–π—Ç–µ —á—É–≤—Å—Ç–≤–∞–º!",
            "‚öîÔ∏è –¢–£–ó –ú–ï–ß–ï–ô": "–ü—Ä–∞–≤–¥–∞, —è—Å–Ω–æ—Å—Ç—å, –ø—Ä–æ—Ä—ã–≤. –ü—Ä–∏—à–ª–æ –≤—Ä–µ–º—è —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π!",
            "üí∞ –¢–£–ó –ü–ï–ù–¢–ê–ö–õ–ï–ô": "–ü—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏–µ, –∏–∑–æ–±–∏–ª–∏–µ, –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—Å–ø–µ—Ö –±–ª–∏–∑–æ–∫!"
        }
        
        # –ö–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –∫–∞—Ä—Ç (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ URL)
        self.card_images = {
            "üÉè –®–£–¢": "https://i.imgur.com/6Q9w7Qa.png",
            "üßô‚Äç‚ôÄÔ∏è –ñ–†–ò–¶–ê": "https://i.imgur.com/8R4wD4k.png", 
            "üëë –ò–ú–ü–ï–†–ê–¢–†–ò–¶–ê": "https://i.imgur.com/9S7wD4l.png",
            "üèõÔ∏è –ò–ú–ü–ï–†–ê–¢–û–†": "https://i.imgur.com/7T5wE9r.png",
            "üìø –ñ–†–ï–¶": "https://i.imgur.com/5R3wD4m.png",
            "üíë –í–õ–Æ–ë–õ–ï–ù–ù–´–ï": "https://i.imgur.com/4R2wD4n.png",
            "‚öîÔ∏è –°–ò–õ–ê": "https://i.imgur.com/3R1wD4p.png",
            "üß≠ –û–¢–®–ï–õ–¨–ù–ò–ö": "https://i.imgur.com/2R0wD4q.png",
            "üé° –ö–û–õ–ï–°–û –§–û–†–¢–£–ù–´": "https://i.imgur.com/1Q9wD4r.png",
            "‚öñÔ∏è –ü–†–ê–í–û–°–£–î–ò–ï": "https://i.imgur.com/0Q8wD4s.png"
        }
        
        # –§—Ä–∞–∑—ã –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º
        self.thinking_phrases = [
            "üîÆ –•–º–º, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å... –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º —á—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –∫–∞—Ä—Ç—ã...",
            "‚ú® –û–∫–µ–π, –ø–æ–Ω—è–ª! –°–µ–π—á–∞—Å —Å–¥–µ–ª–∞—é —Ä–∞—Å–∫–ª–∞–¥...",
            "üí´ –ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –≤–∞—à–µ–º –≤–æ–ø—Ä–æ—Å–µ...",
            "üé¥ –ö–∞—Ä—Ç—ã —É–∂–µ —à–µ–ø—á—É—Ç —Å–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã... –°–µ–∫—É–Ω–¥—É...",
            "üåü –ó–∞–≥–∞–¥—ã–≤–∞—é –≤–∞—à –≤–æ–ø—Ä–æ—Å –∫–∞—Ä—Ç–∞–º –¢–∞—Ä–æ...",
            "üìú –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É—é—Å—å —Å –º—É–¥—Ä–æ—Å—Ç—å—é –ê—Ä–∫–∞–Ω–æ–≤...",
            "üåÄ –ü–æ–≥—Ä—É–∂–∞—é—Å—å –≤ —ç–Ω–µ—Ä–≥–∏—é –≤–∞—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞...",
            "üí≠ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Å–∏—Ç—É–∞—Ü–∏—é —á–µ—Ä–µ–∑ –ø—Ä–∏–∑–º—É –∫–∞—Ä—Ç...",
            "üïØÔ∏è –°–æ–∑–¥–∞—é –¥–ª—è –≤–∞—Å –æ—Å–æ–±—ã–π —Ä–∞—Å–∫–ª–∞–¥...",
            "üåå –ü—Ä–∏—Å–ª—É—à–∏–≤–∞—é—Å—å –∫ –ø–æ—Å–ª–∞–Ω–∏—è–º –í—Å–µ–ª–µ–Ω–Ω–æ–π..."
        ]
        
        # –§—Ä–∞–∑—ã –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
        self.closing_phrases = [
            "–ù–∞–¥–µ—é—Å—å, —Ä–∞—Å–∫–ª–∞–¥ –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –≤–∞—Å! ‚ú®",
            "–ö–∞—Ä—Ç—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å —Å —Å–æ–≤–µ—Ç–æ–º! üåü",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç —Ä–∞—Å–∫–ª–∞–¥ –ø—Ä–∏–Ω–µ—Å–µ—Ç –≤–∞–º —è—Å–Ω–æ—Å—Ç—å! üí´",
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –º—É–¥—Ä–æ—Å—Ç—å –≤–æ –±–ª–∞–≥–æ! üîÆ",
            "–í—Å–µ–ª–µ–Ω–Ω–∞—è –≤—Å–µ–≥–¥–∞ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–Ω—ã–π –ø—É—Ç—å! üåå",
            "–î–æ–≤–µ—Ä—è–π—Ç–µ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏ –∏ –∫–∞—Ä—Ç–∞–º! üé¥",
            "–ü—É—Å—Ç—å –º–∞–≥–∏—è –¢–∞—Ä–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç –≤–∞—Å! ‚ú®",
            "–ü–æ–º–Ω–∏—Ç–µ: –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ —Å–≤–æ—é —Å—É–¥—å–±—É! üíù"
        ]

    def get_thinking_phrase(self):
        """–°–ª—É—á–∞–π–Ω–∞—è —Ñ—Ä–∞–∑–∞ –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º"""
        return random.choice(self.thinking_phrases)
    
    def get_closing_phrase(self):
        """–°–ª—É—á–∞–π–Ω–∞—è —Ñ—Ä–∞–∑–∞ –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞"""
        return random.choice(self.closing_phrases)
    
    def get_card_image(self, card_name):
        """–ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –¥–ª—è –∫–∞—Ä—Ç—ã"""
        clean_name = card_name.split(' ', 1)[1]  # –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏
        return self.card_images.get(card_name, f"https://via.placeholder.com/300x500/667eea/ffffff?text={clean_name}")
    
    def get_contextual_cards(self, question):
        """–ü–æ–¥–±–∏—Ä–∞–µ–º –∫–∞—Ä—Ç—ã –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –≤–æ–ø—Ä–æ—Å–∞"""
        question_lower = question.lower()
        
        # –õ—é–±–æ–≤—å –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è
        if any(word in question_lower for word in ['–ª—é–±–æ–≤', '–æ—Ç–Ω–æ—à–µ–Ω', '–±—Ä–∞–∫', '—Å–µ–º—å', '–ø–∞—Ä—Ç–Ω–µ—Ä', '—á—É–≤—Å—Ç–≤', '—Å–µ—Ä–¥—Ü', '–≤—Å—Ç—Ä–µ—á']):
            love_cards = [
                "üíë –í–õ–Æ–ë–õ–ï–ù–ù–´–ï", 
                "üíù –¢–£–ó –ß–ê–®", 
                "üëë –ö–û–†–û–õ–ï–í–ê –ß–ê–®",
                "‚≠ê –ó–í–ï–ó–î–ê",
                "‚òÄÔ∏è –°–û–õ–ù–¶–ï",
                "üïäÔ∏è –£–ú–ï–†–ï–ù–ù–û–°–¢–¨",
                "üåç –ú–ò–†"
            ]
            return random.sample(love_cards, 3)
        
        # –†–∞–±–æ—Ç–∞ –∏ –∫–∞—Ä—å–µ—Ä–∞
        elif any(word in question_lower for word in ['—Ä–∞–±–æ—Ç', '–∫–∞—Ä—å–µ—Ä', '–¥–µ–Ω—å–≥', '—Ñ–∏–Ω–∞–Ω—Å', '–±–∏–∑–Ω–µ—Å', '–ø—Ä–æ–µ–∫—Ç', '–∑–∞—Ä–ø–ª–∞—Ç']):
            work_cards = [
                "üèõÔ∏è –ò–ú–ü–ï–†–ê–¢–û–†",
                "ü™Ñ –¢–£–ó –ñ–ï–ó–õ–û–í", 
                "ü§¥ –ö–û–†–û–õ–¨ –ñ–ï–ó–õ–û–í",
                "üí∞ –¢–£–ó –ü–ï–ù–¢–ê–ö–õ–ï–ô",
                "üåç –ú–ò–†",
                "üé° –ö–û–õ–ï–°–û –§–û–†–¢–£–ù–´",
                "‚öñÔ∏è –ü–†–ê–í–û–°–£–î–ò–ï"
            ]
            return random.sample(work_cards, 3)
        
        # –ó–¥–æ—Ä–æ–≤—å–µ
        elif any(word in question_lower for word in ['–∑–¥–æ—Ä–æ–≤', '—Å–∞–º–æ—á—É–≤—Å—Ç–≤', '–±–æ–ª–µ–∑–Ω', '—ç–Ω–µ—Ä–≥', '–ª–µ—á–µ–Ω']):
            health_cards = [
                "‚öîÔ∏è –°–ò–õ–ê",
                "‚òÄÔ∏è –°–û–õ–ù–¶–ï", 
                "üïäÔ∏è –£–ú–ï–†–ï–ù–ù–û–°–¢–¨",
                "‚≠ê –ó–í–ï–ó–î–ê",
                "üåç –ú–ò–†",
                "üßô‚Äç‚ôÄÔ∏è –ñ–†–ò–¶–ê",
                "üîÑ –°–£–î"
            ]
            return random.sample(health_cards, 3)
        
        # –ë—É–¥—É—â–µ–µ –∏ —Å—É–¥—å–±–∞
        elif any(word in question_lower for word in ['–±—É–¥—É—â', '—Å—É–¥—å–±', '–∑–∞–≤—Ç—Ä–∞', '–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤', '–∂–∏–∑–Ω']):
            future_cards = [
                "üé° –ö–û–õ–ï–°–û –§–û–†–¢–£–ù–´",
                "üîÑ –°–£–î",
                "üåô –õ–£–ù–ê", 
                "üÉè –®–£–¢",
                "‚òÄÔ∏è –°–û–õ–ù–¶–ï",
                "üíÄ –°–ú–ï–†–¢–¨",
                "üåç –ú–ò–†"
            ]
            return random.sample(future_cards, 3)
        
        # –ü—Ä–æ–±–ª–µ–º—ã –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        elif any(word in question_lower for word in ['–ø—Ä–æ–±–ª–µ–º', '—Å–ª–æ–∂–Ω', '—Å—Ç—Ä–∞—Ö', '—Ç—Ä–µ–≤–æ–≥', '–±–µ—Å–ø–æ–∫–æ', '—Ç—Ä—É–¥–Ω–æ—Å—Ç']):
            problem_cards = [
                "‚öîÔ∏è –°–ò–õ–ê",
                "üòà –î–¨–Ø–í–û–õ", 
                "üè∞ –ë–ê–®–ù–Ø",
                "üôè –ü–û–í–ï–®–ï–ù–ù–´–ô",
                "‚≠ê –ó–í–ï–ó–î–ê",
                "üß≠ –û–¢–®–ï–õ–¨–ù–ò–ö",
                "üïäÔ∏è –£–ú–ï–†–ï–ù–ù–û–°–¢–¨"
            ]
            return random.sample(problem_cards, 3)
        
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - —Å–ª—É—á–∞–π–Ω—ã–µ –∫–∞—Ä—Ç—ã
        else:
            all_cards = list(self.major_arcana.keys()) + list(self.minor_arcana.keys())
            return random.sample(all_cards, 3)
    
    def create_reading(self, question):
        """–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥"""
        selected_cards = self.get_contextual_cards(question)
        
        reading = f"üîÆ **–í–∞—à –≤–æ–ø—Ä–æ—Å:** \"{question}\"\n\n"
        reading += f"‚ú® **–†–∞—Å–∫–ª–∞–¥ –Ω–∞ 3 –∫–∞—Ä—Ç—ã:**\n\n"
        
        positions = ["–ù–∞—Å—Ç–æ—è—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è", "–í–∞—à –ø—É—Ç—å", "–í–æ–∑–º–æ–∂–Ω—ã–π –∏—Å—Ö–æ–¥"]
        
        for i, card in enumerate(selected_cards):
            if card in self.major_arcana:
                meaning = self.major_arcana[card]
            else:
                meaning = self.minor_arcana.get(card, "–ì–ª—É–±–æ–∫–æ–µ –¥—É—Ö–æ–≤–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ")
            
            reading += f"**{positions[i]}:**\n"
            reading += f"üé¥ {card}\n"
            reading += f"*{meaning}*\n\n"
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é
        reading += "---\n"
        reading += "üí´ **–û–±—â–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–∞—Å–∫–ª–∞–¥–∞:**\n"
        
        if "–ª—é–±–æ–≤" in question.lower():
            reading += "–≠—Ç–æ—Ç —Ä–∞—Å–∫–ª–∞–¥ –≥–æ–≤–æ—Ä–∏—Ç –æ –≤–∞–∂–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏. –ö–∞—Ä—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç–∏ –Ω–æ–≤—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º.\n"
        elif "—Ä–∞–±–æ—Ç" in question.lower() or "–∫–∞—Ä—å–µ—Ä" in question.lower():
            reading += "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–∞–∑–≤–∏—Ç–∏–∏. –ö–∞—Ä—Ç—ã —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—è–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–≤–æ–∏—Ö —Å–∏–ª–∞—Ö.\n"
        elif "–∑–¥–æ—Ä–æ–≤" in question.lower():
            reading += "–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å —Ç—Ä–µ–±—É–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è. –ö–∞—Ä—Ç—ã —Å–æ–≤–µ—Ç—É—é—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã –∏ –≥–∞—Ä–º–æ–Ω–∏—é.\n"
        else:
            reading += "–ö–∞—Ä—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏—á–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏. –í–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏–µ–º –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ–º, –¥–æ–≤–µ—Ä—è—è –º—É–¥—Ä–æ—Å—Ç–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–≥–æ.\n"
        
        reading += f"\n{self.get_closing_phrase()}"
        
        return reading, selected_cards
    
    def get_daily_card(self):
        """–ö–∞—Ä—Ç–∞ –¥–Ω—è"""
        card = random.choice(list(self.major_arcana.keys()))
        return f"üé¥ **–ö–∞—Ä—Ç–∞ –¥–Ω—è: {card}**\n\n{self.major_arcana[card]}\n\nüí´ *–ü—É—Å—Ç—å —ç—Ç–∞ –∫–∞—Ä—Ç–∞ –≤–¥–æ—Ö–Ω–æ–≤–∏—Ç –≤–∞—Å —Å–µ–≥–æ–¥–Ω—è!*"

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ò–ò
tarot_ai = TarotAI()

def get_user_balance(user_id):
    """–ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    try:
        conn = sqlite3.connect(DATABASE_PATH)
        c = conn.cursor()
        c.execute('SELECT balance FROM users WHERE user_id = ?', (user_id,))
        result = c.fetchone()
        conn.close()
        
        if result:
            return result[0]
        else:
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            conn = sqlite3.connect(DATABASE_PATH)
            c = conn.cursor()
            c.execute('INSERT OR IGNORE INTO users (user_id, balance) VALUES (?, ?)', 
                     (user_id, 3))  # –î–∞—Ä–∏–º 3 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞
            conn.commit()
            conn.close()
            return 3
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞: {e}")
        return 0

def decrease_balance(user_id):
    """–£–º–µ–Ω—å—à–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞ 1 –≤–æ–ø—Ä–æ—Å"""
    try:
        conn = sqlite3.connect(DATABASE_PATH)
        c = conn.cursor()
        c.execute('UPDATE users SET balance = balance - 1 WHERE user_id = ?', (user_id,))
        conn.commit()
        conn.close()
        return True
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ —É–º–µ–Ω—å—à–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞: {e}")
        return False

# –ö–æ–º–∞–Ω–¥–∞ /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.message.from_user
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å
    balance = get_user_balance(user.id)
    
    welcome_text = (
        f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, {user.first_name}! üëã\n\n"
        f"–ú–µ–Ω—è –∑–æ–≤—É—Ç **–°–ø—É—Ç–Ω–∏–∫**, –∏ —è –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –≤–∞–º —Å –∫–∞—Ä—Ç–∞–º–∏ –¢–∞—Ä–æ.\n\n"
        f"‚ú® **–í–∞—à –±–∞–ª–∞–Ω—Å:** {balance} –≤–æ–ø—Ä–æ—Å–æ–≤\n\n"
        f"–Ø —É–º–µ—é:\n"
        f"‚Ä¢ –î–µ–ª–∞—Ç—å **–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞—Å–∫–ª–∞–¥—ã** –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã\n"
        f"‚Ä¢ –î–∞–≤–∞—Ç—å **–¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è** –∫–∞—Ä—Ç\n" 
        f"‚Ä¢ –ü–æ–¥–±–∏—Ä–∞—Ç—å –∫–∞—Ä—Ç—ã **–ø–æ —Ç–µ–º–∞—Ç–∏–∫–µ** –≤–∞—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞\n"
        f"‚Ä¢ –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å **–±–µ—Å–ø–ª–∞—Ç–Ω—É—é –∫–∞—Ä—Ç—É –¥–Ω—è** (/card)\n"
        f"‚Ä¢ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å **—Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å** (/balance)\n\n"
        f"–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å, –∏ —è —Å–¥–µ–ª–∞—é –¥–ª—è –≤–∞—Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥! üîÆ\n\n"
        f"üí´ *–ß—Ç–æ–±—ã –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞—à–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:*\n"
        f"https://shkarinadust-cmyk.github.io/tarot-bot-miniapps/frontend/"
    )
    
    await update.message.reply_text(welcome_text, parse_mode='Markdown')

# –ö–æ–º–∞–Ω–¥–∞ /balance
async def balance_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.message.from_user
    balance = get_user_balance(user.id)
    
    balance_text = (
        f"üí´ **–í–∞—à –±–∞–ª–∞–Ω—Å:** {balance} –≤–æ–ø—Ä–æ—Å–æ–≤\n\n"
        f"–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–æ–∂–Ω–æ –≤ –Ω–∞—à–µ–º –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:\n"
        f"https://shkarinadust-cmyk.github.io/tarot-bot-miniapps/frontend/"
    )
    
    await update.message.reply_text(balance_text, parse_mode='Markdown')

# –ö–æ–º–∞–Ω–¥–∞ /card
async def daily_card(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ö–∞—Ä—Ç–∞ –¥–Ω—è"""
    card_reading = tarot_ai.get_daily_card()
    await update.message.reply_text(card_reading, parse_mode='Markdown')

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ã—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_message = update.message.text
    user = update.message.from_user
    
    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã —Ç–∏–ø–∞ "–î–∞", "–ù–µ—Ç"
    if user_message.lower() in ['–¥–∞', '–Ω–µ—Ç', '–æ–∫', '—Ö–æ—Ä–æ—à–æ', '—Å–ø–∞—Å–∏–±–æ', '–ø–æ–Ω—è—Ç–Ω–æ']:
        await update.message.reply_text(
            "üí´ –ó–∞–¥–∞–π—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –¥–ª—è —Ä–∞—Å–∫–ª–∞–¥–∞!\n\n"
            "–ù–∞–ø—Ä–∏–º–µ—Ä:\n"
            "‚Ä¢ ¬´–ß—Ç–æ –º–µ–Ω—è –∂–¥–µ—Ç –≤ –ª—é–±–≤–∏ –¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞?¬ª\n" 
            "‚Ä¢ ¬´–ö–∞–∫ —Å–ª–æ–∂–∏—Ç—Å—è –º–æ—è –∫–∞—Ä—å–µ—Ä–∞?¬ª\n"
            "‚Ä¢ ¬´–°—Ç–æ–∏—Ç –ª–∏ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç?¬ª\n"
            "‚Ä¢ ¬´–ß—Ç–æ –¥—É–º–∞–µ—Ç –æ–±–æ –º–Ω–µ —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫?¬ª\n\n"
            "–Ø —Å–¥–µ–ª–∞—é –¥–ª—è –≤–∞—Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥ –∏–∑ 3 –∫–∞—Ä—Ç! üîÆ",
            parse_mode='Markdown'
        )
        return
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
    balance = get_user_balance(user.id)
    
    if balance <= 0:
        await update.message.reply_text(
            "‚ùå **–£ –≤–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã!**\n\n"
            "–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –Ω–∞—à–µ –≤–æ–ª—à–µ–±–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ, –ø–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å:\n\n"
            "üí´ *–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:*\n"
            "https://shkarinadust-cmyk.github.io/tarot-bot-miniapps/frontend/\n\n"
            "–ü–æ—Å–ª–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞ –Ω–æ–≤—ã–º–∏ —Ä–∞—Å–∫–ª–∞–¥–∞–º–∏! üîÆ",
            parse_mode='Markdown'
        )
        return
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ—Ä–∞–∑—É "–¥—É–º–∞—é"
    thinking_message = await update.message.reply_text(
        f"{tarot_ai.get_thinking_phrase()}",
        parse_mode='Markdown'
    )
    
    # –ò–º–∏—Ç–∏—Ä—É–µ–º "–¥—É–º–∞–Ω–∏–µ"
    await update.message.reply_chat_action(action='typing')
    time.sleep(2)
    
    # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–¥—É–º–∞—é"
    await thinking_message.delete()
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ò–ò –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å–∫–ª–∞–¥–∞
    answer, selected_cards = tarot_ai.create_reading(user_message)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∫–∞—Ä—Ç
    for card in selected_cards:
        try:
            image_url = tarot_ai.get_card_image(card)
            await update.message.reply_photo(
                photo=image_url,
                caption=f"üé¥ {card}",
                parse_mode='Markdown'
            )
            time.sleep(1)  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏: {e}")
            # –ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
            await update.message.reply_text(f"üé¥ {card}", parse_mode='Markdown')
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–∞—Å–∫–ª–∞–¥
    await update.message.reply_text(answer, parse_mode='Markdown')
    
    # –£–º–µ–Ω—å—à–∞–µ–º –±–∞–ª–∞–Ω—Å
    if decrease_balance(user.id):
        new_balance = balance - 1
        await update.message.reply_text(
            f"üí´ **–û—Å—Ç–∞–ª–æ—Å—å –≤–æ–ø—Ä–æ—Å–æ–≤:** {new_balance}",
            parse_mode='Markdown'
        )
    else:
        await update.message.reply_text(
            "‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–ø–∏—Å–∞–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.",
            parse_mode='Markdown'
        )

# –û—à–∏–±–∫–∏
async def error(update: Update, context: ContextTypes.DEFAULT_TYPE):
    logger.warning(f'Update {update} caused error {context.error}')

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
def main():
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(BOT_TOKEN).build()
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("balance", balance_command))
    application.add_handler(CommandHandler("card", daily_card))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
    application.add_error_handler(error)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("ü§ñ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("‚úÖ –£–º–Ω—ã–π –ò–ò –¢–∞—Ä–æ: –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ —Ä–∞—Å–∫–ª–∞–¥–∞–º–∏")
    print("üñºÔ∏è  –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∫–∞—Ä—Ç")
    print("üí¨  –î–æ–±–∞–≤–ª–µ–Ω—ã –∂–∏–≤—ã–µ —Ñ—Ä–∞–∑—ã")
    print("üé¥  –®–£–¢ –≤–º–µ—Å—Ç–æ –®–ê–õ–£–ù–ê")
    print("üí´ –û–∂–∏–¥–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã...")
    
    application.run_polling()
    print("‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç!")

if __name__ == '__main__':
    main()